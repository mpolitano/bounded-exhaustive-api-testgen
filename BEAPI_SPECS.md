# Analysis of Specifications using `BEAPI` (RQ3 in Section 4.3 of the paper)

In this section, we analize the `repOKs` provided with the benchmarks, with the help of `BEAPI`.

## Running a single experiment to find mismatching between repOK and the API.


First, move to the scripts folder.


```
cd script
```

To evaluate if the set of structures generated by  `BEAPI` is included in the set of structures generated by `Korat` run the following script:

```
./run-inclusion-beapi-in-korat.sh <benchmark> <case study> <beapi scope> <korat scope> 
```
 
To evaluate if the set of structures generated by  `Korat` is included in the set of structures generated by `BEAPI`, we run the following script:

```
./run-inclusion-korat-in-beapi.sh <benchmark> <case study> <korat scope> <beapi scope>  
```


In these above scripts,  `<benchmark>` is one of `0_korat`, `1_kiasan`, `2_roops`, `3_fajita`; `<case study>` is one of the case studies of `<benchmark>` listed in the subsection below; `<beapi scope>` is the scope used to generate inputs with `BEAPI`; and `<korat scope>` is the scope used by `Korat` to generate inputs from `repOK`.


***For simplicity from now on, we will refer to the set of inputs generated with `BEAPI` as `APISet`, and the set of structures generated by `Korat` as `RepOKSet`.***

All the structures include in `APISet` that are not included in `RepOkSet`, and vice versa, will witness a  mismatching between `repOK` and the `API`. Notice that, this mismatching must be confirm manually.


As an example,  to analize `NodeCachingLinkedList` from `2_roops` benchmark, execute:

```
./run-inclusion-beapi-in-korat.sh 2_roops ncl.NodeCachingLinkedList 3 3
```

At the end of its execution, the script shows a summary of the results in CSV format:


```
************
Report
Project,Class,Technique,Budget,Other Bdgt,Structures,Other Strs,Not Included,Not Incl %
2_roops,ncl.NodeCachingLinkedList,beapi/matching/builders,3,3,18,228,0,0
************
```

where:

- **Project**: the name of the selected benchmark.
- **Class**: the name of the case study.
- **Technique**: `BEAPI (DEFAULT)`, since we are checking that `APISet` is a subset of `REPOKSet`
- **Budget**: the scope (maximum number of nodes, integers, etc...) used for generate `APISet`
- **Other Bdgt**: the scope (maximum number of nodes, integers, etc...) used for generate `REPOKSet`
- **Structures**: the number of structures in `APISet`
- **Other Strs**: the number of structures in `REPOKSet`
- **Not Included**: the number of structures in `APISet` not included  in `REPOKSet`.
- **Not Incl %**: the percentage of structures in `APISet` not included  in `REPOKSet`.


As can be observed,  all structures generated by `BEAPI` (18) are incluided in the set of structures generated by `Korat` (228), since, 0 `BEAPI` structures are **Not Included** in `Korat's` generated structures. It is noticeable in this case,  that `RepOKset` is a  proper superset of `APISet`
 
To analize what is happening with the structures belonging to `REPOKSet` that are not in `APISet`, execute:


```
./run-inclusion-korat-in-beapi.sh 2_roops ncl.NodeCachingLinkedList 3 3
```

At the end of its execution the script shows a summary of the results in CSV format:

```
************
Report
Project,Class,Technique,Budget,Other Bdgt,Structures,Other Strs,Not Included,Not Incl %
2_roops,ncl.NodeCachingLinkedList,korat,3,3,228,18,210,92.1
************
```

where:

- **Project**: the name of the selected benchmark.
- **Class**: the name of the case study.
- **Technique**: `Korat`, since we are checking that `REPOKSet` is a subset of `APISET`
- **Budget**: the scope (maximum number of nodes, integers, etc...) used for generate `REPOKSet `
- **Other Bdgt**: the scope (maximum number of nodes, integers, etc...) used for generate `APISet `
- **Structures**: the number of structures in `REPOKSet `
- **Other Strs**: the number of structures in `APISet `
- **Not Included**: the number of structures in `REPOKSet` not included  in `APISet `.
- **Not Incl %**: the percentage of structures in `REPOKSet ` not included  in `APISet `.



As can be seen, 210 structures of `REPOKSet` are not included in `APISet`. These 210 structures are pointing out a mismatching between `repOK` and the `API`. Even more, all these structures were identified and, stored in plain text in `results-begen-inclusion/2_roops/ncl.NodeCachingLinkedList/korat/3/structures-not-included-3.txt`, for further analysis. 








In **Table 3** of **Section 4.3** of the paper can be seen the `repOK` error (underspecification) reported for this case. By inspection of `repOk` source code (`0_korat/src/main/java/korat/examples/redblacktree/RedBlackTree.java`) you can see the reported bug.







Notice that **Table 3** of **Section 4.3** of the paper reports errors found in `repOK` that are part of the case studies of each benchmark. In this table the **Error Description** column shows a brief description of the error found in `repOK`, which was manually identified. All `repOK` errors reported on the table previously mentioned, can be found in the corresponding `java` source file located at `<benchmark>/src/main/java/<case study>` for each `<benchmark>` and `<case study>`. In particular, the reported errors in roops'2 NodeCachingLinkeList it also shown as a part of motivation example section of the paper.





COMPLETAR INDICANDO DONDE DEJA LOS OBJETOS SERALIZADOS PARA AMBAS TECNICAS . 



## Available case studies

- `0_korat`
  - `DoublyLinkedList`: korat.examples.doublylinkedlist.DoublyLinkedList (`DDList`)
  - `FibonacciHeap`: korat.examples.fibheap.FibonacciHeap (`FibHeap`)
  -	`BinomialHeap`: korat.examples.binheap.BinomialHeap (`BinHeap`)
  - `SearchTree`:korat.examples.searchtree.SearchTree (`BST`)
  - `SinglyLinkedList`: korat.examples.singlylinkedlist.SinglyLinkedList (`SLList`)
  - `RedBlackTree`: korat.examples.redblacktree.RedBlackTree (`RBT`)
  - `SortedList`: korat.examples.sortedlist.SortedList (`SortedList`) 

- `1_kiasan`
  - `BinarySearchTree`: binarysearchtree.BinarySearchTree (`BST`)
  - `DoubleLinkedList`: doublylinkedlist.DoubleLinkedList (`DDL`)
  - `TreeSet`: redblacktree.TreeSet(`RBT`) UBICAR LOS FUENTES DONDE CORRESPONDE con el nombre correcto
  - `DisjSetsFast`: disjointSet.fast.DisjSetsFast (`DisjSetFast`)
  - `StackLi`: stack.list.StackLi (`StackList`)
  - `BinaryHeap`: binaryheap.BinaryHeap (`BHeap`)
  - `TreeMap`: redblacktree.TreeMap (`TreeMap`)
  - `DisjSet`: disjointSet.orig.DisjSets (`DisjSet`) 

- `2_roops`

  - `AvlTree`: avl.AvlTree (`AVL`)
  - `NodeCachingLinkedList`: ncl.NodeCachingLinkedList (`NCL`)
  - `BinTree`: bintree.BinTree (`BinTree`)
  - `LinkedList`: linkedlist.LinkedList (`LList`)
  - `TreeSet`: rbt.TreeSet (`RBT`)
  - `FibHeap`: fibheap.FibHeap (`FibHeap`)
  - `BinomialHeap`: bheap.BinomialHeap (`BinHeap`)


- `3_fajita`
  - `BinTree`: bintree1.BinTree (`BinTree`)
  - `AvlTree`: avl1.AvlTree (`AVL`)
  - `TreeSet`: rbt.TreeSet (`RBT`)
  - `BinomialHeap`: bheap.BinomialHeap (`BinHeap`)
  - `SinglyLinkedList`: list.SinglyLinkedList (`SLList`) 
  - `DoubleLinkedList`: cdlist.LinkedList (`DLList`)
  - `NodeCachingLinkedList`: cList.NodeCachingLinkedList (`NCL`)


