# Analysis of Specifications using `BEAPI` (RQ3 in Section 4.3 of the paper)

In this section, we analize the `repOKs` provided with the benchmarks, with the help of `BEAPI`.

## Running a single experiment to find mismatching between repOK and the API.


First, move to the scripts folder.


```
cd script
```

To evaluate if `repOK` suffer  from underspecification (missing constraint) run the following script:

```
./run-inclusion-beapi-in-korat.sh <benchmark> <case study> <beapi scope> <korat scope> 
```

In this case we will be evaluating if the structures generated using the API are a subset of the valid structures (generated from `repOK`),  and those valid structures that are not  generated by the API (if any),  will be witness structures of a `repOK` missing constraint (which must be manually confirmed).


To evaluate if `repOK` suffer  from overspecification (`repOK` is too strong) run the following script:

```
./run-inclusion-korat-in-beapi.sh <benchmark> <case study> <korat scope> <beapi scope>  
```

In this case we will be evaluating if the valid structures (generated from `repOK`) are a subset of structures generated from the API,  and those API generated structures that are not valid according to `repOk` (if any), will be pointing out  `repOK` errors, which must be manually confirmed.


In these above scripts,  `<benchmark>` is one of `0_korat`, `1_kiasan`, `2_roops`, `3_fajita`; `<case study>` is one of the case studies of `<benchmark>` listed in the subsection below; `<beapi scope>` is the scope used to generate inputs with `BEAPI`; and `<korat scope>` is the scope used by `Korat` to generate inputs from `repOK`.



For example, to check `BEAPI` inclusion in `Korat` (`repOk` underspecification) for `RedBlackTree` from the `0_korat` benchmark, execute: 


```
./run-inclusion-beapi-in-korat.sh 0_korat korat.examples.redblacktree.RedBlackTree 3 3
```

At the end of its execution the script shows a summary of the results in CSV format:


CACHO: creo que acá en la ejecución falta la palabra Report
```
************
Report
Project,Class,Technique,Budget,Other Bdgt,Structures,Other Strs,Not Included,Not Incl %
0_korat,korat.examples.redblacktree.RedBlackTree,beapi/matching/builders,3,3,11,16,0,0
************
```

where:

- **Project**: the name of the selected benchmark.
- **Class**: the name of the case study.
- **Technique**: the generation technique that we want to evaluate if it is included in a second technique (`Korat`)
- **Budget**: the scope (maximum number of nodes, integers, etc...) used for the first technique (`BEAPI`) generation.
- **Other Bdgt**: the scope (maximum number of nodes, integers, etc...) used for the first technique (`Korat`) generation.
- **Structures**: the number of structures generated by the first technique (`BEAPI`) 
- **Other Strs**: the number of structures generated by the second technique (`Korat`)
- **Not Included**: the number of structures generated by the first technique (`BEAPI`) that were not generated by the second technique (`Korat`)
- **Not Incl %**: the percentage of structures generated by the first technique (`BEAPI`) that were not generated by the second technique (`Korat`)



As can be seen,  all structures generated by `BEAPI` (11) are incluided in the structures generated by `Korat` (16). In other words, 0 `BEAPI` structures are **Not Included** in `Korat's` generated structures. Also, as you can note, `Korat` generate 5 more structures than `BEAPI`. In **Table 3** of **Section 4.3** of the paper can be seen the `repOK` error (underspecification) reported for this case. By inspection of `repOk` source code (`0_korat/src/main/java/korat/examples/redblacktree/RedBlackTree.java`) you can see the reported bug.


As another example, running the following scripts: 

```
./run-inclusion-beapi-in-korat.sh 0_korat korat.examples.singlylinkedlist.SinglyLinkedList  3 3
./run-inclusion-korat-in-beapi.sh 0_korat korat.examples.singlylinkedlist.SinglyLinkedList  3 3
```


EXPLICAR QUE SON IGUALES



Note: All bugs reported on **Table 3** of **Section 4.3** of the paper, can be found at `<benchmark>/src/main/java/<case study package path>/<class name>.java`


COMPLETAR INDICANDO DONDE DEJA LOS OBJETOS SERALIZADOS PARA AMBAS TECNICAS . 



## Available case studies

- `0_korat`
  - `DoublyLinkedList`: korat.examples.doublylinkedlist.DoublyLinkedList (`DDList`)
  - `FibonacciHeap`: korat.examples.fibheap.FibonacciHeap (`FibHeap`)
  -	`BinomialHeap`: korat.examples.binheap.BinomialHeap (`BinHeap`)
  - `SearchTree`:korat.examples.searchtree.SearchTree (`BST`)
  - `SinglyLinkedList`: korat.examples.singlylinkedlist.SinglyLinkedList (`SLList`)
  - `RedBlackTree`: korat.examples.redblacktree.RedBlackTree (`RBT`)
  - `SortedList`: korat.examples.sortedlist.SortedList (`SortedList`) 

- `1_kiasan`
  - `BinarySearchTree`: binarysearchtree.BinarySearchTree (`BST`)
  - `DoubleLinkedList`: doublylinkedlist.DoubleLinkedList (`DDL`)
  - `TreeSet`: redblacktree.TreeSet(`RBT`) UBICAR LOS FUENTES DONDE CORRESPONDE con el nombre correcto
  - `DisjSetsFast`: disjointSet.fast.DisjSetsFast (`DisjSetFast`)
  - `StackLi`: stack.list.StackLi (`StackList`)
  - `BinaryHeap`: binaryheap.BinaryHeap (`BHeap`)
  - `TreeMap`: redblacktree.TreeMap (`TreeMap`)
  - `DisjSet`: disjointSet.orig.DisjSets (`DisjSet`) 
  - `StackAr`: stack.array.StackAr (`StackAr`)

- `2_roops`

  - `AvlTree`: avl.AvlTree (`AVL`)
  - `NodeCachingLinkedList`: ncl.NodeCachingLinkedList (`NCL`)
  - `BinTree`: bintree.BinTree (`BinTree`)
  - `LinkedList`: linkedlist.LinkedList (`LList`)
  - `TreeSet`: rbt.TreeSet (`RBT`)
  - `FibHeap`: fibheap.FibHeap (`FibHeap`)
  - `BinomialHeap`: bheap.BinomialHeap (`BinHeap`)


- `3_fajita`
  - `BinTree`: bintree1.BinTree (`BinTree`)
  - `AvlTree`: avl1.AvlTree (`AVL`)
  - `TreeSet`: rbt.TreeSet (`RBT`)
  - `BinomialHeap`: bheap.BinomialHeap (`BinHeap`)
  - `SinglyLinkedList`: list.SinglyLinkedList (`SLList`) 
  - `DoubleLinkedList`: cdlist.LinkedList (`DLList`)
  - `NodeCachingLinkedList`: cList.NodeCachingLinkedList (`NCL`)


